<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒã‚¤ãƒŠãƒ“ãƒã‚¤ãƒˆ ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ãƒã‚¤ãƒˆè¨ºæ–­ | æ€§æ ¼Ã—æ¡ä»¶ã§ãƒãƒƒãƒãƒ³ã‚°</title>
    <style>
        /* ========== ãƒªã‚»ãƒƒãƒˆãƒ»åŸºæœ¬è¨­å®š ========== */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: #f0f4f8; font-family: "Helvetica Neue", Arial, "Hiragino Kaku Gothic ProN", "Hiragino Sans", Meiryo, sans-serif; color: #333; line-height: 1.6; }
        
        .diagnosis-container { max-width: 600px; margin: 0 auto; background: #fff; min-height: 100vh; box-shadow: 0 0 20px rgba(0,0,0,0.05); position: relative; overflow: hidden; }

        /* ========== å…±é€šãƒœã‚¿ãƒ³ã‚¹ã‚¿ã‚¤ãƒ« ========== */
        .btn {
            display: block; width: 100%; padding: 16px;
            background: linear-gradient(135deg, #00A0E9 0%, #0077C8 100%);
            color: white; border: none; border-radius: 12px;
            font-size: 16px; font-weight: bold; cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s; text-decoration: none; text-align: center;
            box-shadow: 0 4px 6px rgba(0, 160, 233, 0.2);
        }
        .btn:active { transform: scale(0.98); }
        .btn-secondary { background: #e2e8f0; color: #4a5568; box-shadow: none; margin-top: 10px; }

        /* ========== ç”»é¢å…±é€š ========== */
        .screen { padding: 30px 20px; display: none; animation: fadeIn 0.4s ease; }
        .screen.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        h1 { color: #00A0E9; font-size: 24px; text-align: center; margin-bottom: 10px; }
        h2 { font-size: 20px; margin-bottom: 20px; text-align: center; color: #2d3748; }

        /* ========== ã‚¹ã‚¿ãƒ¼ãƒˆç”»é¢ ========== */
        .hero-img { width: 100%; max-width: 250px; display: block; margin: 20px auto; }
        .tag-line { text-align: center; color: #718096; font-size: 14px; margin-bottom: 30px; }

        /* ========== è³ªå•ç”»é¢ ========== */
        .progress-area { margin-bottom: 20px; }
        .progress-bar { height: 6px; background: #edf2f7; border-radius: 3px; overflow: hidden; }
        .progress-fill { height: 100%; background: #00A0E9; width: 0%; transition: width 0.3s ease; }
        .q-number { font-size: 12px; color: #00A0E9; font-weight: bold; margin-bottom: 5px; display: block; }

        .question-card { margin-bottom: 30px; }
        .question-text { font-size: 18px; font-weight: bold; margin-bottom: 20px; line-height: 1.5; }

        /* é¸æŠè‚¢ã‚¹ã‚¿ã‚¤ãƒ« */
        .options-vertical { display: flex; flex-direction: column; gap: 12px; }
        .option-btn {
            padding: 15px; border: 2px solid #e2e8f0; border-radius: 12px;
            background: #fff; cursor: pointer; text-align: left; transition: all 0.2s;
            position: relative;
        }
        .option-btn:hover { border-color: #00A0E9; background: #f0f9ff; }
        .option-btn.selected { border-color: #00A0E9; background: #e6f6ff; color: #0077C8; font-weight: bold; }
        
        /* ãƒãƒ£ãƒ¼ãƒˆåˆ†å²è³ªå•ç”¨ã®ç‰¹åˆ¥ã‚¹ã‚¿ã‚¤ãƒ« */
        .chart-question { border: 2px solid #ffd700; background: #fffbe6; padding: 20px; border-radius: 15px; }
        .chart-badge { background: #ffd700; color: #333; font-size: 12px; padding: 2px 8px; border-radius: 4px; font-weight: bold; vertical-align: middle; margin-right: 5px; }

        /* ========== çµæœç”»é¢ ========== */
        .result-header { text-align: center; margin-bottom: 30px; }
        .result-type { font-size: 28px; font-weight: bold; color: #00A0E9; margin: 10px 0; }
        .match-tags { display: flex; justify-content: center; gap: 5px; margin-bottom: 15px; }
        .tag { font-size: 11px; padding: 4px 10px; border-radius: 20px; background: #edf2f7; color: #4a5568; }
        .tag.highlight { background: #ebf8ff; color: #00A0E9; border: 1px solid #00A0E9; }

        .job-card {
            background: #fff; border: 1px solid #e2e8f0; border-radius: 12px;
            padding: 20px; margin-bottom: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.02);
            border-left: 5px solid #00A0E9;
        }
        .job-title { font-size: 18px; font-weight: bold; margin-bottom: 5px; }
        .job-wage { color: #e53e3e; font-weight: bold; font-size: 16px; }

        /* ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒãƒ£ãƒ¼ãƒˆï¼ˆç°¡æ˜“CSSç‰ˆï¼‰ */
        .chart-area { display: flex; justify-content: space-between; align-items: flex-end; height: 100px; padding: 0 20px; margin: 20px 0; border-bottom: 1px solid #ccc; }
        .chart-bar-group { display: flex; flex-direction: column; align-items: center; width: 15%; }
        .chart-bar { width: 100%; background: #bee3f8; border-radius: 4px 4px 0 0; transition: height 1s ease; height: 0; position: relative; }
        .chart-bar.main { background: #00A0E9; }
        .chart-label { font-size: 10px; margin-top: 5px; text-align: center; }

        /* ã‚·ã‚§ã‚¢ãƒœã‚¿ãƒ³ */
        .share-area { display: flex; gap: 10px; margin-top: 20px; }
        .share-btn { flex: 1; padding: 10px; border-radius: 8px; text-align: center; color: white; text-decoration: none; font-size: 14px; font-weight: bold; }
        .x-share { background: #000; }
        .line-share { background: #00c300; }

    </style>
</head>
<body>

<div class="diagnosis-container">
    
    <!-- 1. ã‚¹ã‚¿ãƒ¼ãƒˆç”»é¢ -->
    <div id="screen-start" class="screen active">
        <div style="text-align: center; padding-top: 40px;">
            <div style="font-size: 60px; margin-bottom: 10px;">ğŸ“</div>
            <h1>ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰<br>ãƒã‚¤ãƒˆè¨ºæ–­</h1>
            <p class="tag-line">æ€§æ ¼ã‚¹ã‚³ã‚¢ Ã— ã“ã ã‚ã‚Šæ¡ä»¶ã§<br>ã€Œæœ¬å½“ã«ç¶šãã€ãƒã‚¤ãƒˆã‚’è¦‹ã¤ã‘ã‚‹</p>
            
            <div style="background: #f7fafc; padding: 20px; border-radius: 10px; text-align: left; font-size: 14px; color: #4a5568; margin: 20px 0;">
                <p><strong>ğŸ’¡ è¨ºæ–­ã®ä»•çµ„ã¿</strong></p>
                <ul style="padding-left: 20px; margin-top: 5px;">
                    <li>å‰åŠï¼šã‚ãªãŸã®å¾—æ„ãªã“ã¨ã‚’åˆ†æ</li>
                    <li>å¾ŒåŠï¼šã©ã†ã—ã¦ã‚‚è­²ã‚Œãªã„æ¡ä»¶ã‚’é¸æŠ</li>
                    <li>AIãŒæœ€é©ãªæ±‚äººã‚’ãƒãƒƒãƒãƒ³ã‚°ï¼</li>
                </ul>
            </div>

            <button class="btn" onclick="startDiagnosis()">è¨ºæ–­ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
        </div>
    </div>

    <!-- 2. è³ªå•ç”»é¢ -->
    <div id="screen-question" class="screen">
        <div class="progress-area">
            <span class="q-number" id="qNumber">Q1 / 10</span>
            <div class="progress-bar"><div id="progressFill" class="progress-fill"></div></div>
        </div>

        <div id="questionContainer"></div>

        <!-- ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã¯é¸æŠè‚¢ã‚¯ãƒªãƒƒã‚¯ã§è‡ªå‹•é·ç§»ã•ã›ã‚‹ãŸã‚éè¡¨ç¤º -->
        <div style="margin-top: 20px; text-align: center;">
            <button class="btn btn-secondary" onclick="prevQuestion()" id="prevBtn" style="display:none; width: auto; margin: 0 auto; padding: 10px 30px;">æˆ»ã‚‹</button>
        </div>
    </div>

    <!-- 3. ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚° -->
    <div id="screen-loading" class="screen" style="text-align: center; padding-top: 100px;">
        <div style="font-size: 50px; animation: spin 1s infinite linear; display: inline-block;">âŒ›</div>
        <h2 style="margin-top: 20px;">åˆ†æä¸­...</h2>
        <p>æ€§æ ¼é©æ€§ã¨æ¡ä»¶ã‚’<br>ã‚¯ãƒ­ã‚¹é›†è¨ˆã—ã¦ã„ã¾ã™</p>
    </div>

    <!-- 4. çµæœç”»é¢ -->
    <div id="screen-result" class="screen">
        <div class="result-header">
            <p style="font-size: 12px; color: #718096;">ã‚ãªãŸã«ãƒ”ãƒƒã‚¿ãƒªãªã®ã¯...</p>
            <div class="match-tags" id="matchTags"></div>
            <h1 class="result-type" id="resultTitle"></h1>
            <p id="resultDesc" style="font-size: 14px; padding: 0 10px;"></p>
        </div>

        <!-- ç°¡æ˜“ã‚°ãƒ©ãƒ• -->
        <div class="chart-area" id="scoreChart">
            <!-- JSã§ç”Ÿæˆ -->
        </div>

        <h3 style="font-size: 16px; margin-bottom: 15px; border-bottom: 2px solid #edf2f7; padding-bottom: 5px;">ãŠã™ã™ã‚ã®ãƒã‚¤ãƒˆæ±‚äºº</h3>
        <div id="jobList"></div>

        <div style="margin-top: 30px; background: #f7fafc; padding: 20px; border-radius: 12px;">
            <p style="text-align: center; font-size: 14px; margin-bottom: 10px;">çµæœã‚’ã‚·ã‚§ã‚¢ã—ã¦ä¿å­˜</p>
            <div class="share-area">
                <a href="#" id="shareX" class="share-btn x-share" target="_blank">Xã§ã‚·ã‚§ã‚¢</a>
                <a href="#" id="shareLine" class="share-btn line-share" target="_blank">LINEé€ã‚‹</a>
            </div>
        </div>

        <div style="margin-top: 20px;">
            <a href="https://baito.mynavi.jp/" class="btn" target="_blank">ãƒã‚¤ãƒŠãƒ“ãƒã‚¤ãƒˆã§æ¢ã™</a>
            <button class="btn btn-secondary" onclick="location.reload()">ã‚‚ã†ä¸€åº¦è¨ºæ–­ã™ã‚‹</button>
        </div>
    </div>

</div>

<script>
    /* ========== ãƒ‡ãƒ¼ã‚¿å®šç¾© ========== */
    
    // ã‚«ãƒ†ã‚´ãƒªå®šç¾© (åŠ ç®—ç”¨)
    // æ¥å®¢(Service), ä½œæ¥­(Task), å‰µé€ (Creative), ä½“åŠ›(Physical)

    const questions = [
        // --- Phase 1: åŠ ç®—å‹ãƒ‘ãƒ¼ãƒˆ (æ€§æ ¼ãƒ»é©æ€§) Q1-Q8 ---
        { id: 1, text: "åˆå¯¾é¢ã®äººã¨è©±ã™ã®ã¯è‹¦ã§ã¯ãªã„", type: "score", cat: "Service", weight: 2 },
        { id: 2, text: "é»™ã€…ã¨ç´°ã‹ã„ä½œæ¥­ã‚’ã™ã‚‹ã®ãŒå¥½ãã ", type: "score", cat: "Task", weight: 2 },
        { id: 3, text: "ä½“ã‚’å‹•ã‹ã—ã¦æ±—ã‚’ã‹ãã®ã¯æ°—æŒã¡ã„ã„", type: "score", cat: "Physical", weight: 2 },
        { id: 4, text: "å›°ã£ã¦ã„ã‚‹äººã‚’è¦‹ã‚‹ã¨æ”¾ã£ã¦ãŠã‘ãªã„", type: "score", cat: "Service", weight: 1 },
        { id: 5, text: "æ•´ç†æ•´é “ã‚„ãƒ‡ãƒ¼ã‚¿å…¥åŠ›ãŒå¾—æ„ã ", type: "score", cat: "Task", weight: 2 },
        { id: 6, text: "æ–°ã—ã„ã‚¢ã‚¤ãƒ‡ã‚¢ã‚’è€ƒãˆã‚‹ã®ãŒå¥½ã", type: "score", cat: "Creative", weight: 3 },
        { id: 7, text: "ä½“åŠ›ã«ã¯è‡ªä¿¡ãŒã‚ã‚‹æ–¹ã ", type: "score", cat: "Physical", weight: 2 },
        { id: 8, text: "æµè¡Œã‚„ãƒˆãƒ¬ãƒ³ãƒ‰ã«ã¯æ•æ„Ÿã ", type: "score", cat: "Creative", weight: 1 },

        // --- Phase 2: ãƒãƒ£ãƒ¼ãƒˆå‹ãƒ‘ãƒ¼ãƒˆ (æ¡ä»¶åˆ†å²) Q9-Q10 ---
        // ã“ã“ã§ã®å›ç­”ã¯ã‚¹ã‚³ã‚¢åŠ ç®—ã§ã¯ãªãã€çµæœã®ã€Œãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã€ã«ä½¿ã„ã¾ã™
        { 
            id: 9, 
            text: "åƒãç’°å¢ƒã€ã©ã£ã¡ãŒã„ã„ï¼Ÿ", 
            type: "chart", 
            tag: "Environment", // ç’°å¢ƒåˆ†å²
            options: [
                { label: "ä»²é–“ã¨ãƒ¯ã‚¤ãƒ¯ã‚¤è³‘ã‚„ã‹ã«", val: "Team" },
                { label: "ä¸€äººã§ãƒ¢ã‚¯ãƒ¢ã‚¯ã¨", val: "Solo" }
            ]
        },
        { 
            id: 10, 
            text: "ãƒã‚¤ãƒˆã«æ±‚ã‚ã‚‹å„ªå…ˆé †ä½ã¯ï¼Ÿ", 
            type: "chart", 
            tag: "Priority", // å„ªå…ˆåº¦åˆ†å²
            options: [
                { label: "ã¨ã«ã‹ãç¨¼ããŸã„ (é«˜æ™‚çµ¦)", val: "Money" },
                { label: "ç„¡ç†ãªãåƒããŸã„ (å®‰å®š)", val: "Easy" }
            ]
        }
    ];

    // é€šå¸¸ã®ã‚¹ã‚³ã‚¢åŠ ç®—ç”¨ã®é¸æŠè‚¢
    const baseOptions = [
        { label: "ã‚ã¦ã¯ã¾ã‚‹", score: 2 },
        { label: "ã‚„ã‚„ã‚ã¦ã¯ã¾ã‚‹", score: 1 },
        { label: "ã‚ã¾ã‚Šã‚ã¦ã¯ã¾ã‚‰ãªã„", score: 0 }
    ];

    // --- çµæœãƒ‡ãƒ¼ã‚¿ï¼ˆãƒãƒˆãƒªã‚¯ã‚¹ï¼‰ ---
    // filterKey: {Environment}_{Priority} ã®çµ„ã¿åˆã‚ã›ã«å¯¾å¿œ
    // mainCat: ãã®ãƒ•ã‚£ãƒ«ã‚¿å†…ã§ã€ã©ã®ã‚¹ã‚³ã‚¢ãŒé«˜ã‹ã£ãŸã‚‰ã“ã‚Œã‚’å‡ºã™ã‹
    const results = [
        /* === Solo (ä¸€äºº) Ã— Money (ç¨¼ã) === */
        { 
            filterKey: "Solo_Money", 
            mainCat: "Physical", // ä½“åŠ›ã‚¹ã‚³ã‚¢ãŒé«˜ã„å ´åˆ
            title: "é«˜åå…¥ãƒ»é…é€ãƒ‰ãƒ©ã‚¤ãƒãƒ¼", 
            desc: "ä¸€äººã®æ™‚é–“ã‚’ç¢ºä¿ã—ã¤ã¤ã€ä½“ã‚’å‹•ã‹ã—ã¦ã‚¬ãƒƒãƒ„ãƒªç¨¼ãï¼ã‚ãªãŸã®ä½“åŠ›ã¨é›†ä¸­åŠ›ãŒæ­¦å™¨ã«ãªã‚Šã¾ã™ã€‚",
            tags: ["#ä¸€äººã§æ°—æ¥½", "#é«˜åå…¥"],
            jobs: [{t:"ãƒ‡ãƒªãƒãƒªãƒ¼ã‚¹ã‚¿ãƒƒãƒ•", w:"1,300å††~"}, {t:"å¼•ã£è¶Šã—ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ", w:"1,400å††~"}]
        },
        { 
            filterKey: "Solo_Money", 
            mainCat: "Task", // ä½œæ¥­ã‚¹ã‚³ã‚¢ãŒé«˜ã„å ´åˆ
            title: "æ·±å¤œã®ãƒ‡ãƒ¼ã‚¿å…¥åŠ›ãƒ»è­¦å‚™", 
            desc: "æ·±å¤œæ‰‹å½“ã§åŠ¹ç‡ã‚ˆãç¨¼ãï¼é™ã‹ãªç’°å¢ƒã§æ­£ç¢ºã«æ¥­å‹™ã‚’ã“ãªã™ã‚ãªãŸã«æœ€é©ã€‚",
            tags: ["#æ·±å¤œå‰²å¢—", "#ãƒ¢ã‚¯ãƒ¢ã‚¯ä½œæ¥­"],
            jobs: [{t:"å¤œå‹¤ãƒ‡ãƒ¼ã‚¿å…¥åŠ›", w:"1,350å††~"}, {t:"æ–½è¨­è­¦å‚™å“¡", w:"1,250å††~"}]
        },
        /* === Solo (ä¸€äºº) Ã— Easy (æ¥½/å®‰å®š) === */
        { 
            filterKey: "Solo_Easy", 
            mainCat: "Task", 
            title: "ã‚³ãƒ„ã‚³ãƒ„è»½ä½œæ¥­ãƒ»æ¤œå“", 
            desc: "æ¥å®¢ãªã—ã§ç²¾ç¥çš„ã«å®‰å®šã€‚è‡ªåˆ†ã®ãƒšãƒ¼ã‚¹ã§ä¸å¯§ã«ä»•äº‹ãŒã§ãã‚‹ç’°å¢ƒã§ã™ã€‚",
            tags: ["#æ¥å®¢ãªã—", "#ãƒã‚¤ãƒšãƒ¼ã‚¹"],
            jobs: [{t:"å€‰åº«å†…ãƒ”ãƒƒã‚­ãƒ³ã‚°", w:"1,100å††~"}, {t:"ã‚·ãƒ¼ãƒ«è²¼ã‚Š", w:"1,050å††~"}]
        },
        { 
            filterKey: "Solo_Easy", 
            mainCat: "Creative", 
            title: "åœ¨å®…ãƒ¯ãƒ¼ã‚¯ãƒ»ãƒ¢ãƒ‹ã‚¿ãƒ¼", 
            desc: "å®¶ã§ãƒªãƒ©ãƒƒã‚¯ã‚¹ã—ãªãŒã‚‰ã€ã‚ãªãŸã®æ„Ÿæ€§ã‚„æ„è¦‹ã‚’ãŠé‡‘ã«å¤‰ãˆã‚‹åƒãæ–¹ã€‚",
            tags: ["#åœ¨å®…", "#ã‚¹ã‚­ãƒæ™‚é–“"],
            jobs: [{t:"ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆãƒ¢ãƒ‹ã‚¿ãƒ¼", w:"å‡ºæ¥é«˜åˆ¶"}, {t:"ãƒ†ã‚¹ãƒˆæ¡ç‚¹", w:"1,100å††~"}]
        },

        /* === Team (å¤§å‹¢) Ã— Money (ç¨¼ã) === */
        { 
            filterKey: "Team_Money", 
            mainCat: "Service", 
            title: "ã‚¤ãƒ™ãƒ³ãƒˆãƒ»ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³", 
            desc: "ãƒãƒ¼ãƒ ä¸€ä¸¸ã¨ãªã£ã¦ç››ã‚Šä¸Šã’ã‚‹ï¼å¿™ã—ã„ã‘ã©æ™‚çµ¦ã‚‚ã‚„ã‚ŠãŒã„ã‚‚æŠœç¾¤ã€‚",
            tags: ["#å¤§é‡å‹Ÿé›†", "#é«˜æ™‚çµ¦"],
            jobs: [{t:"ã‚¤ãƒ™ãƒ³ãƒˆã‚¹ã‚¿ãƒƒãƒ•", w:"1,500å††~"}, {t:"ãƒ‘ãƒãƒ³ã‚³åº—ãƒ›ãƒ¼ãƒ«", w:"1,400å††~"}]
        },
        { 
            filterKey: "Team_Money", 
            mainCat: "Physical", 
            title: "å±…é…’å±‹ãƒ›ãƒ¼ãƒ«(ç¹å¿™åº—)", 
            desc: "æ´»æ°—ã‚ãµã‚Œã‚‹åº—å†…ã§å‹•ãå›ã‚‹ï¼å¿™ã—ã•ã‚’æ¥½ã—ã‚€ä½“è‚²ä¼šç³»ã®ãƒãƒªãŒåˆã£ã¦ã„ã¾ã™ã€‚",
            tags: ["#ã¾ã‹ãªã„æœ‰", "#ä»²é–“ãŒã§ãã‚‹"],
            jobs: [{t:"å±…é…’å±‹ãƒ›ãƒ¼ãƒ«", w:"1,250å††~"}, {t:"ãƒ“ã‚¢ã‚¬ãƒ¼ãƒ‡ãƒ³", w:"1,300å††~"}]
        },

        /* === Team (å¤§å‹¢) Ã— Easy (æ¥½/å®‰å®š) === */
        { 
            filterKey: "Team_Easy", 
            mainCat: "Service", 
            title: "ã‚«ãƒ•ã‚§ãƒ»ãƒ•ã‚¡ãƒŸãƒ¬ã‚¹", 
            desc: "ãƒãƒ‹ãƒ¥ã‚¢ãƒ«å®Œå‚™ã§å®‰å¿ƒã€‚åŒä¸–ä»£ã®ä»²é–“ã¨æ¥½ã—ãåƒã‘ã‚‹å®šç•ªãƒã‚¤ãƒˆã€‚",
            tags: ["#æœªçµŒé¨“OK", "#ã‚·ãƒ•ãƒˆèé€š"],
            jobs: [{t:"ã‚«ãƒ•ã‚§ã‚¹ã‚¿ãƒƒãƒ•", w:"1,100å††~"}, {t:"ãƒ•ã‚¡ãƒŸãƒ¬ã‚¹", w:"1,150å††~"}]
        },
        { 
            filterKey: "Team_Easy", 
            mainCat: "Creative", 
            title: "é›‘è²¨ãƒ»ã‚¢ãƒ‘ãƒ¬ãƒ«è²©å£²", 
            desc: "å¥½ããªã‚‚ã®ã«å›²ã¾ã‚Œã¦åƒãã€‚ã‚ãªãŸã®ã‚»ãƒ³ã‚¹ã§ãŠå®¢æ§˜ã«ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã€‚",
            tags: ["#ç¤¾å‰²ã‚ã‚Š", "#ã‚ªã‚·ãƒ£ãƒ¬"],
            jobs: [{t:"ã‚¢ãƒ‘ãƒ¬ãƒ«è²©å£²", w:"1,100å††~"}, {t:"é›‘è²¨å±‹ã‚¹ã‚¿ãƒƒãƒ•", w:"1,080å††~"}]
        }
    ];

    // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼ˆè©²å½“ãªã—ã®å ´åˆï¼‰
    const fallbackResult = {
        title: "ã‚³ãƒ³ãƒ“ãƒ‹ã‚¹ã‚¿ãƒƒãƒ•",
        desc: "ã©ã‚“ãªã‚¿ã‚¤ãƒ—ã§ã‚‚é©å¿œã§ãã‚‹ã‚ªãƒ¼ãƒ«ãƒ©ã‚¦ãƒ³ãƒ€ãƒ¼ãªã‚ãªãŸã¸ã€‚",
        tags: ["#è¿‘æ‰€ã§åƒã", "#å®‰å®š"],
        jobs: [{t:"ã‚³ãƒ³ãƒ“ãƒ‹", w:"1,050å††~"}]
    };

    /* ========== çŠ¶æ…‹ç®¡ç† ========== */
    let currentQIndex = 0;
    let scores = { Service: 0, Task: 0, Physical: 0, Creative: 0 };
    let chartFilters = { Environment: "", Priority: "" };

    /* ========== é–¢æ•° ========== */

    function startDiagnosis() {
        document.getElementById('screen-start').classList.remove('active');
        document.getElementById('screen-question').classList.add('active');
        renderQuestion();
    }

    function renderQuestion() {
        const q = questions[currentQIndex];
        const container = document.getElementById('questionContainer');
        
        // é€²æ—ãƒãƒ¼æ›´æ–°
        const progress = ((currentQIndex) / questions.length) * 100;
        document.getElementById('progressFill').style.width = `${progress}%`;
        document.getElementById('qNumber').textContent = `Q${currentQIndex + 1} / ${questions.length}`;
        
        // æˆ»ã‚‹ãƒœã‚¿ãƒ³åˆ¶å¾¡
        document.getElementById('prevBtn').style.display = currentQIndex > 0 ? 'block' : 'none';

        // è³ªå•HTMLç”Ÿæˆ
        let optionsHtml = '';

        if (q.type === 'score') {
            // åŠ ç®—å‹è³ªå•
            baseOptions.forEach(opt => {
                optionsHtml += `
                    <button class="option-btn" onclick="answerScore('${q.cat}', ${q.weight}, ${opt.score})">
                        ${opt.label}
                    </button>
                `;
            });
            container.innerHTML = `
                <div class="question-card">
                    <div class="question-text">${q.text}</div>
                    <div class="options-vertical">${optionsHtml}</div>
                </div>
            `;
        } else {
            // ãƒãƒ£ãƒ¼ãƒˆå‹è³ªå•ï¼ˆã‚­ãƒ©ãƒ¼ã‚¯ã‚¨ã‚¹ãƒãƒ§ãƒ³ï¼‰
            q.options.forEach(opt => {
                optionsHtml += `
                    <button class="option-btn" onclick="answerChart('${q.tag}', '${opt.val}')">
                        ${opt.label}
                    </button>
                `;
            });
            container.innerHTML = `
                <div class="question-card">
                    <div class="chart-badge">âš¡ ã“ã“ã‹ã‚‰ã¯æ¡ä»¶åˆ†å²</div>
                    <div class="question-text">${q.text}</div>
                    <div class="options-vertical">${optionsHtml}</div>
                </div>
            `;
        }
    }

    function answerScore(category, weight, point) {
        // ã‚¹ã‚³ã‚¢åŠ ç®—
        scores[category] += (point * weight);
        next();
    }

    function answerChart(tag, value) {
        // ãƒ•ã‚£ãƒ«ã‚¿æ¡ä»¶ä¿å­˜
        chartFilters[tag] = value;
        next();
    }

    function next() {
        if (currentQIndex < questions.length - 1) {
            currentQIndex++;
            // ãƒ•ã‚§ãƒ¼ãƒ‰æ¼”å‡ºã®ãŸã‚ã«å°‘ã—é…ã‚‰ã›ã‚‹ç­‰ã¯çœç•¥
            renderQuestion();
        } else {
            finishDiagnosis();
        }
    }

    function prevQuestion() {
        if(currentQIndex > 0) {
            // ã‚¹ã‚³ã‚¢æ¸›ç®—ãƒ­ã‚¸ãƒƒã‚¯ã¯çœç•¥ï¼ˆå³å¯†ã«ã™ã‚‹ãªã‚‰å±¥æ­´ç®¡ç†ãŒå¿…è¦ï¼‰
            // ç°¡æ˜“çš„ã«æˆ»ã‚‹ã ã‘å®Ÿè£…
            currentQIndex--;
            renderQuestion();
        }
    }

    function finishDiagnosis() {
        document.getElementById('screen-question').classList.remove('active');
        document.getElementById('screen-loading').classList.add('active');
        
        setTimeout(() => {
            calcResult();
            document.getElementById('screen-loading').classList.remove('active');
            document.getElementById('screen-result').classList.add('active');
        }, 1500);
    }

    function calcResult() {
        // 1. ãƒãƒ£ãƒ¼ãƒˆãƒ•ã‚£ãƒ«ã‚¿ã®ã‚­ãƒ¼ã‚’ä½œæˆ (ä¾‹: "Solo_Money")
        const key = `${chartFilters.Environment}_${chartFilters.Priority}`;
        
        // 2. ã‚¹ã‚³ã‚¢ãŒæœ€ã‚‚é«˜ã„ã‚«ãƒ†ã‚´ãƒªã‚’ç‰¹å®š
        //    (åŒç‚¹ã®å ´åˆã¯ Service > Task > Physical > Creative ã®é †ã¨ã™ã‚‹)
        let maxScore = -1;
        let bestCat = "Service";
        
        for (const [cat, score] of Object.entries(scores)) {
            if (score > maxScore) {
                maxScore = score;
                bestCat = cat;
            }
        }

        // 3. ãƒãƒƒãƒãƒ³ã‚°
        //    ãƒ•ã‚£ãƒ«ã‚¿ã‚­ãƒ¼ãŒä¸€è‡´ã—ã€ã‹ã¤ mainCat ãŒãƒ™ã‚¹ãƒˆã‚«ãƒ†ã‚´ãƒª(ã¾ãŸã¯ä»£æ›¿)ãªã‚‚ã®ã‚’æ¢ã™
        //    â€» å³å¯†ã«ä¸€è‡´ã—ãªã„å ´åˆã¯ã€ãã®ãƒ•ã‚£ãƒ«ã‚¿ã‚­ãƒ¼ã®ä¸­ã§ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆçš„ãªã‚‚ã®ã‚’å‡ºã™ãƒ­ã‚¸ãƒƒã‚¯ã‚‚å¯
        let result = results.find(r => r.filterKey === key && r.mainCat === bestCat);
        
        // è¦‹ã¤ã‹ã‚‰ãªã„å ´åˆï¼ˆãƒ¬ã‚¢ã‚±ãƒ¼ã‚¹ï¼‰ã¯ã€ã‚­ãƒ¼ãŒåˆã†ã‚‚ã®ã®å…ˆé ­ã‚’ä½¿ç”¨
        if (!result) {
            result = results.find(r => r.filterKey === key) || fallbackResult;
        }

        // --- è¡¨ç¤ºã¸ã®åæ˜  ---
        document.getElementById('resultTitle').textContent = result.title;
        document.getElementById('resultDesc').textContent = result.desc;
        
        // ã‚¿ã‚°
        const tagHtml = result.tags.map((t, i) => 
            `<span class="tag ${i===0?'highlight':''}">${t}</span>`
        ).join('');
        document.getElementById('matchTags').innerHTML = tagHtml;

        // æ±‚äººãƒªã‚¹ãƒˆ
        const jobHtml = result.jobs.map(j => `
            <div class="job-card">
                <div style="display:flex; justify-content:space-between; align-items:center;">
                    <div class="job-title">${j.t}</div>
                    <div class="job-wage">${j.w}</div>
                </div>
            </div>
        `).join('');
        document.getElementById('jobList').innerHTML = jobHtml;

        // ã‚·ã‚§ã‚¢ãƒªãƒ³ã‚¯
        const shareText = `ç§ã®é©è·ã¯ã€${result.title}ã€‘ã§ã—ãŸï¼æ€§æ ¼é©æ€§Ã—æ¡ä»¶ã§è¨ºæ–­ğŸ”`;
        document.getElementById('shareX').href = `https://twitter.com/intent/tweet?text=${encodeURIComponent(shareText)}&url=${encodeURIComponent(location.href)}`;
        document.getElementById('shareLine').href = `https://social-plugins.line.me/lineit/share?url=${encodeURIComponent(location.href)}`;

        // ãƒãƒ£ãƒ¼ãƒˆæç”»
        drawChart(bestCat);
    }

    function drawChart(bestCat) {
        const chartContainer = document.getElementById('scoreChart');
        const labels = { Service:"æ¥å®¢", Task:"ä½œæ¥­", Physical:"ä½“åŠ›", Creative:"å‰µé€ " };
        
        // æœ€å¤§ã‚¹ã‚³ã‚¢ã«å¯¾ã™ã‚‹å‰²åˆã§é«˜ã•ã‚’æ±ºå®š
        const maxVal = Math.max(...Object.values(scores)) || 1;

        let html = '';
        for (const [key, val] of Object.entries(scores)) {
            const height = (val / maxVal) * 80 + 20; // æœ€å°20%
            const isMain = key === bestCat ? 'main' : '';
            html += `
                <div class="chart-bar-group">
                    <div class="chart-bar ${isMain}" style="height: ${height}%"></div>
                    <div class="chart-label">${labels[key]}</div>
                </div>
            `;
        }
        chartContainer.innerHTML = html;
    }

</script>
</body>
</html>
